"use strict";var netElem=document.getElementById("original-network"),hostsElem=document.getElementById("host-number"),maskElem=document.getElementById("subnet-mask"),slashElem=document.getElementById("mask-slash"),isIp=function(s){return s&&3<s.split(".").length},checkIp=function(t){return netElem.classList.contains("border-danger")&&netElem.classList.remove("border-danger"),netElem.classList.contains("border-warning")||netElem.classList.add("border-warning"),netElem.classList.add("border-warning"),new Promise(async function(e,s){try{return await axios.get("/valid-ip",{params:{ip:t}}),netElem.classList.contains("border-warning")&&netElem.classList.remove("border-warning"),e({isErr:!1})}catch(s){return e({isErr:!0,err:s.response.data})}})},checkMask=function(r){return maskElem.classList.contains("border-danger")&&maskElem.classList.remove("border-danger"),maskElem.classList.contains("border-warning")||maskElem.classList.add("border-warning"),maskElem.classList.add("border-warning"),new Promise(async function(e,s){try{var t=(await axios.get("/valid-mask",{params:{mask:r}})).data;return maskElem.classList.contains("border-warning")&&maskElem.classList.remove("border-warning"),hostsElem.value=t.hosts,slashElem.value=t.slash,e({isErr:!1})}catch(s){return e({isErr:!0,err:s.response.data})}})},isNormalInteger=function(s){var e=Math.floor(Number(s));return e!==1/0&&String(e)===s&&0<=e},netCorrect=function(){isNetError=!1,netElem.classList.contains("border-warning")&&netElem.classList.remove("border-warning"),netElem.classList.contains("border-danger")&&netElem.classList.remove("border-danger"),netElem.classList.contains("border-success")||netElem.classList.add("border-success")},netWrong=function(s){isNetError=!0,netElem.classList.contains("border-danger")||netElem.classList.add("border-danger"),netElem.classList.contains("border-success")&&netElem.classList.remove("border-success"),s&&(document.getElementById("subnet-bad").textContent=s)},isNetError=!0;netElem.addEventListener("input",async function(){if(!isIp(netElem.value))return isNetError=!0,netElem.classList.contains("border-success")&&netElem.classList.remove("border-success"),netElem.classList.contains("border-warning")&&netElem.classList.remove("border-warning"),void(netElem.classList.contains("border-danger")&&netElem.classList.remove("border-danger"));var s=await checkIp(netElem.value);s.isErr?netWrong(s.err):netCorrect(),hasTyped()});var hostCorrect=function(){isHostError=!1,hostsElem.classList.contains("border-danger")&&hostsElem.classList.remove("border-danger"),hostsElem.classList.contains("border-success")||hostsElem.classList.add("border-success")},hostWrong=function(){isHostError=!0,hostsElem.classList.contains("border-danger")||hostsElem.classList.add("border-danger"),hostsElem.classList.contains("border-success")&&hostsElem.classList.remove("border-success")},isHostError=!0;hostsElem.addEventListener("input",async function(){var s=parseInt(hostsElem.value);isNormalInteger(hostsElem.value)&&0<s&&s<=254?(await getSubnet(hostsElem.value,null,null),hostCorrect()):hostWrong(),hasTyped()});var maskCorrect=function(){isMaskError=!1,maskElem.classList.contains("border-warning")&&maskElem.classList.remove("border-warning"),maskElem.classList.contains("border-danger")&&maskElem.classList.remove("border-danger"),maskElem.classList.contains("border-success")||maskElem.classList.add("border-success")},maskWrong=function(s){isMaskError=!0,maskElem.classList.contains("border-danger")||maskElem.classList.add("border-danger"),maskElem.classList.contains("border-success")&&maskElem.classList.remove("border-success"),s&&(document.getElementById("subnet-bad").textContent=s)},isMaskError=!0;maskElem.addEventListener("input",async function(){var s=maskElem.value.startsWith("255.255.255.")?maskElem.value.split("255.255.255.")[1]:maskElem.value,s=await checkMask(s);s.isErr?maskWrong(s.err):(await getSubnet(hostsElem.value,maskElem.value,null),maskCorrect()),hasTyped()});var slashCorrect=function(){isSlashError=!1,slashElem.classList.contains("border-danger")&&slashElem.classList.remove("border-danger"),slashElem.classList.contains("border-success")||slashElem.classList.add("border-success")},slashWrong=function(){isSlashError=!0,slashElem.classList.contains("border-danger")||slashElem.classList.add("border-danger"),slashElem.classList.contains("border-success")&&slashElem.classList.remove("border-success")},isSlashError=!0;slashElem.addEventListener("input",async function(){var s=parseInt(slashElem.value);isNormalInteger(slashElem.value)&&24<=s&&s<=30?(await getSubnet(hostsElem.value,null,slashElem.value),slashCorrect()):slashWrong(),hasTyped()});var getSubnet=function(a,n,o){return new Promise(async function(s,e){var t,r;n?(t=(await axios.get("/from-mask",{params:{mask:n,hosts:a}})).data,slashElem.value=t.slash,hostsElem.value=t.hosts):o?(r=(await axios.get("/from-slash",{params:{slash:o,hosts:a}})).data,maskElem.value=r.mask,hostsElem.value=r.hosts):a&&(r=(await axios.get("/from-hosts",{params:{hosts:a}})).data,maskElem.value=r.mask,slashElem.value=r.slash),hostCorrect(),maskCorrect(),slashCorrect(),hasTyped(),s()})},setError=function(s){document.getElementById("subnet-bad").textContent=s,document.getElementById("subnet-ok").style.display="none",document.getElementById("subnet-bad").style.display="block"},hasTyped=async function(){return isNetError?setError("Please enter a valid IP address"):isHostError?setError("Please enter a valid host number"):isMaskError?setError("Please enter a valid subnet mask"):isSlashError?setError("Please enter a valid slash notation"):await getData()},getData=function(){return new Promise(async function(e,s){try{var t=(await axios.post("/",{ip:netElem.value,host:hostsElem.value})).data,r=t.baseIp,a=t.firstIp,n=t.lastIp,o=t.mask,l=t.slash,t=t.maxHosts;document.getElementById("ok-ip").innerHTML=r+"."+a+" <strong><small><i>/"+l+"</i></small></strong>",document.getElementById("ok-hostrange").innerHTML=r+"."+(a+1)+" &rarr; "+r+"."+(n-1),document.getElementById("ok-hostnumber").innerHTML=t+" hosts",document.getElementById("ok-broadcast").innerHTML=r+"."+n,document.getElementById("ok-mask").innerHTML="255.255.255."+o,document.getElementById("subnet-ok").style.display="block",document.getElementById("subnet-bad").style.display="none"}catch(s){document.getElementById("subnet-ok").style.display="none",document.getElementById("subnet-bad").style.display="block",document.getElementById("subnet-bad").textContent=s.response&&s.response.data||s,e(s)}})};